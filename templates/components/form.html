{% macro form_begin(args) %}
{% set label = args.label %}
{% set columns = args.columns %}
{% set last_column = args.last_column|default(true) %}
{% set required = args.required or false %}
{% set hotkeys = args.hotkeys or none %}
{% set row = args.row|default(true) %}
{% set no_label = args.no_label or false %}
{% set label_wrap = args.label_wrap|default(true) %}
{% if row %}
<div class="grid grid-cols-1 lg:grid-cols-12 gap-4">
{% endif %}
  <div
    class="{% if columns %}lg:col-span-{{ columns }} {% else %}lg:col-span-6{% endif %}form-control w-full"
    {% if hotkeys %}data-hotkey="{{ hotkeys }}"{% endif %}
  >
    {% if not no_label %}
    <label class="label">
      <span class="label-text font-medium">
        {{ _(label) }}
        {% if required %}
          <span class="text-error">*</span>
        {% endif %}
      </span>
    {% if not label_wrap %}
    </label>
    {% endif %}
    {% endif %}
{% endmacro %}

{% macro form_end(args) %}
{% set help_text = args.help_text or none %}
{% set row = args.row|default(true) %}
{% set no_label = args.no_label or false %}
{% set label_wrap = args.label_wrap|default(true) %}
  {% if not no_label and label_wrap %}
    </label>
  {% endif %}
  {% if help_text %}
    <div class="label">
      <span class="label-text-alt text-base-content/70">{{ _(help_text)|safe }}</span>
    </div>
  {% endif %}
  </div>
{% if row %}
</div>
{% endif %}
{% endmacro %}

{% macro form_attr(form_class, args) %}
{% set disabled = args.disabled or false %}
{% set required = args.required or false %}
{% set autofocus = args.autofocus or false %}
{% set noAutocomplete = args.noAutocomplete or false %}
{% macro form_attr(form_class, args) %}
{% set disabled = args.disabled or false %}
{% set required = args.required or false %}
{% set autofocus = args.autofocus or false %}
{% set noAutocomplete = args.noAutocomplete or false %}
{% set extra_style = args.extra_style or false %}
{% set extra_class = args.extra_class %}
{% set extra_attr = args.extra_attr %}
{% set date = args.date or false %}
{% set time = args.time or false %}
{% set datetime = args.datetime or false %}
  class="{{ form_class }}{% if extra_class %} {{ extra_class }}{% endif %}"
  {% if disabled %}disabled{% endif %}
  {% if required %}required{% endif %}
  {% if autofocus %}autofocus data-autofocus{% endif %}
  {% if noAutocomplete %}autocomplete="off"{% endif %}
  {% if datetime %}data-pick-datetime{% endif %}
  {% if date %}data-pick-date{% endif %}
  {% if time %}data-pick-time{% endif %}
  {% if extra_attr %}{{ extra_attr }}{% endif %}
  {% if extra_style %}style="{{extra_style}}"{% endif %}
{% endmacro %}

{% macro container_attr(container_class, args) %}
{% set extra_class = args.extra_class or none %}
  class="{{ container_class }}{% if extra_class %} {{ extra_class }}{% endif %}"
{% endmacro %}

{% macro select(args) %}
<div
  name="form_item_{{ args.name }}"
  {{ container_attr('w-full', args) }}
>
  <select
    name="{{ args.name }}"
    {{ form_attr('select select-bordered w-full', args) }}
  >
  {%- for k, v in args.options -%}
    <option value="{{ k }}"{% if args.value == k %} selected{% endif %}>
      {{ _(v) }}
    </option>
  {%- endfor -%}
  </select>
</div>
{% endmacro %}

{% macro form_select(args) %}
{{ form_begin({columns:5}|assign(args)) }}
{{ select(args) }}
{{ form_end(args) }}
{% endmacro %}

{% macro radio(args) %}
<div
  name="form_item_{{ args.name }}"
  {{ container_attr('flex flex-col gap-2', args) }}
>
{%- for k, v in options -%}
  <div class="form-control">
    <label class="label cursor-pointer justify-start gap-3">
      <input
        value="{{ k }}"
        type="radio"
        name="{{ v }}"
        {{ form_attr('radio radio-primary', args) }}
        {% if value == args.id %} checked{% endif %}
      />
      <span class="label-text">{{ _(v) }}</span>
    </label>
  </div>
{%- endfor -%}
</div>
{% endmacro %}

{% macro form_radio(args) %}
{{ form_begin({columns:5, label_wrap:false}|assign(args)) }}
{{ radio(args) }}
{{ form_end({label_warp:false}|assign(args)) }}
{% endmacro %}

{% macro image_radio(args) %}
<div
  name="form_item_{{ args.name }}"
  {{ container_attr('grid grid-cols-2 md:grid-cols-4 gap-4', args) }}
>
{%- for k, v in options -%}
  <div class="form-control">
    <label class="label cursor-pointer flex-col gap-2 p-4 border-2 border-base-300 rounded-lg hover:border-primary transition-colors">
      <input
        value="{{ k }}"
        type="radio"
        name="{{ args.name }}"
        {{ form_attr('radio radio-primary', args) }}
        {% if value == k %} checked{% endif %}
      />
      <div class="w-full h-20 bg-base-300 rounded {{ image_class.format(k) }} tooltip" data-tip="{{ _(v) }}"></div>
      <span class="label-text text-center">{{ _(v) }}</span>
    </label>
  </div>
{%- endfor -%}
</div>
{% endmacro %}

{% macro form_image_radio(args) %}
{{ form_begin({columns:8, label_warp:false}|assign(args)) }}
{{ image_radio(args) }}
{{ form_end({label_warp:false}|assign(args)) }}
{% endmacro %}

{% macro text(args) %}
<div
  name="form_item_{{ args.name }}"
  {{ container_attr('textbox-container', args) }}
>
  <input
    type="{{ 'number' if args.type === 'float' else args.type|default('text') }}"
    name="{{ args.name }}"
    value="{{ args.value }}"
    {% if args.type === 'float' %} step="any"{% endif %}
    placeholder="{{ args.placeholder }}"
    {{ form_attr('textbox', args) }}
  >
</div>
{% endmacro %}

{% macro form_text(args) %}
{{ form_begin({columns:5}|assign(args)) }}
{{ text(args) }}
{{ form_end(args) }}
{% endmacro %}

{% macro textarea(args) %}
{% set markdown = args.markdown or false %}
{% set nospellcheck = args.nospellcheck or false %}
<div
  name="form_item_{{ args.name }}"
  {{ container_attr('textarea-container', args) }}
>
  <textarea
    name="{{ args.name }}"
    placeholder="{{ args.placeholder }}"
    {% if markdown %}data-markdown{% endif %}
    {% if nospellcheck %}spellcheck="false"{% endif %}
    {{ form_attr('textbox', args) }}
  >{{ args.value }}</textarea>
</div>
{% endmacro %}

{% macro form_textarea(args) %}
{{ form_begin({columns:10}|assign(args)) }}
{{ textarea(args) }}
{{ form_end(args) }}
{% endmacro %}

{% macro checkbox(args) %}
<div
  name="form_item_{{ args.name }}"
  {{ container_attr('checkbox-container', args) }}
>
  <label class="checkbox">
    <input type="checkbox" name="{{ args.name }}"{% if args.value %} checked{% endif %}
      {{ form_attr('checkbox', args) }}
    >{% if args.placeholder %}{{ _(args.placeholder) }}{% endif %}
  </label>
</div>
{% endmacro %}

{% macro form_checkbox(args) %}
{{ form_begin({columns:5}|assign(args)) }}
{{ checkbox(args) }}
{{ form_end(args) }}
{% endmacro %}
